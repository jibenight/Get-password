---
import { getLangFromUrl, useTranslations } from '../i18n/utils';
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<div class="content-tabs">
  <div class="tabs-nav">
    <button class="tab-button active" data-tab="security">
      {t('tab.security')}
    </button>
    <button class="tab-button" data-tab="memorization">
      {t('tab.memorization')}
    </button>
    <button class="tab-button" data-tab="manager">
      {t('tab.manager')}
    </button>
  </div>

  <div class="tabs-content">
    <div class="tab-panel active" data-panel="security">
      <slot name="security" />
    </div>
    <div class="tab-panel" data-panel="memorization">
      <slot name="memorization" />
    </div>
    <div class="tab-panel" data-panel="manager">
      <slot name="manager" />
    </div>
  </div>
</div>

<style>
  .content-tabs {
    width: 100%;
    max-width: 1024px;
    margin: 0 auto;
  }

  .tabs-nav {
    display: flex;
    gap: 0.75rem;
    margin-bottom: 1.5rem;
    padding: 0.5rem;
    background: var(--color-bg-primary);
    border-radius: 16px;
    box-shadow: var(--shadow-soft);
  }

  .tab-button {
    flex: 1;
    padding: 0.75rem 1rem;
    border: none;
    border-radius: 12px;
    background: var(--color-bg-primary);
    color: var(--color-text-secondary);
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    box-shadow: none;
    transition: all 0.3s ease;
  }

  .tab-button:hover {
    color: var(--color-text-primary);
    box-shadow: var(--shadow-soft);
    transform: none;
  }

  .tab-button.active {
    background: var(--color-accent);
    color: #ffffff;
    box-shadow: var(--shadow-inset);
  }

  .tab-button:active {
    box-shadow: var(--shadow-inset);
  }

  .tabs-content {
    background: var(--color-bg-primary);
    border-radius: 20px;
    box-shadow: var(--shadow-soft);
    padding: 2rem;
  }

  .tab-panel {
    display: none;
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .tab-panel.active {
    display: block;
    opacity: 1;
  }

  @media (max-width: 768px) {
    .tabs-nav {
      flex-direction: column;
      gap: 0.5rem;
    }

    .tabs-content {
      padding: 1.5rem;
    }
  }
</style>

<script>
  function initContentTabs() {
    const tabButtons = document.querySelectorAll('.tab-button');
    const tabPanels = document.querySelectorAll('.tab-panel');

    tabButtons.forEach(button => {
      button.addEventListener('click', () => {
        const targetTab = button.getAttribute('data-tab');

        tabButtons.forEach(btn => btn.classList.remove('active'));
        tabPanels.forEach(panel => panel.classList.remove('active'));

        button.classList.add('active');
        const targetPanel = document.querySelector(`.tab-panel[data-panel="${targetTab}"]`);
        if (targetPanel) {
          targetPanel.classList.add('active');
        }
      });
    });
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initContentTabs);
  } else {
    initContentTabs();
  }

  document.addEventListener('astro:page-load', initContentTabs);
  document.addEventListener('astro:after-swap', initContentTabs);
</script>
